# Mount Locker Ransomware Analysis

So, I have got the Mount Locker payload executable (hehehe) let the fun begin...

## Static Analysis

Hash - SHA - 187610fb06cc60c73c0062b593c5fe3ba29e0436e396969feb9ed25391ff7e8b

Let's see if the executable is packed or unpacked...

![DiE](DiE.PNG)

Looks like our executable is not packed because most of the time before the actual payload is dropped in Mountlocker would have disabled any security protections out in the victims machine. So, typically they have no need to avoid detection via packer.

Let load the malware in the PE studio

![pestud](pestudio.PNG)

No of VirusTotal hits

![vt_hits](VT_hits.PNG)

Let's have look into the libraries (dll's) being imported...

![Libs](Libs.PNG)

`shell32.dll` `user32.dll` `ntdll.dll` `kernel32.dll` `advapi32.dll` `shlwapi.dll` `msvcrt.dll` mate can you make it more obvious? Long stroy short when you see shlwapi, advapi32 and ntdll32 together, you can most probably be certain it can be malicious...
Let's take a look into the imports from the libraries

![Imports](Imports.PNG)

:warning: Please ignore the marker I was messing around and didnt notice as my lappy was processing the move slowly and I have motive to snip it again and loose time.

So The strings can say alot ZwQuerySysInfo (ntdll.dll) is used mainly to detect debuggers and debuggin env, also you can see the key generation and encryption functions...

Now lets take a look into the strings present in the executable.

![strings](Strings_imp.PNG)

Also you can take you can use the [strings file](strings_mount.txt) to see the full readable strings present.

Now lets load this bad boi into cutter and cut it open xD.

So, to reduce all the mess I have put the global graph where you can take a look the how the executable disassembled func'.

![global](global_callgraph.png)

:warning: Zoom into the pic I promise you it has better visibility and does not look as worst you can see xD.

## Dynamic Analysis

As I am lazy and I have patch the executable to avoid the debugger instance and then debugging it I have simply choose to run the malware and take alook into how it's running and the modules that it is using via process hacker.

![Module_inuse](Modules_inuse.PNG)

The process how this malware is encrypting the files.

![Dynamic_output.PNG](Dynamic_output.PNG)

After completing encrypting the file it seems to log the event into a log file but surprisingly this file didnt delete even after encrypting the entire system files...

You can take a look into the log file

![logs](logs.PNG)

As you can see it is recording somesort of performance and during the static code analysis similar lines have been printed into Console function but didnt see it was logging.

Time, Size and Speed at which it was able to complete the task.

So, for every folder it encrypts it leave a READMANUAL.html where the ransome note is left.

The file extension the malware leaves behind is.

![File_extension.PNG](File_extension.PNG)

Ransom Notes are as followed as I have disabled host to guest connection to stop the spread of malware I am simply putting the screenshot of ransowe notes.
![RNote1.PNG](RNote1.PNG)
![RNote2.PNG](RNote2.PNG)

IOC's are RecoveryManual.html, unusal file extension

![File_extension.PNG](File_extension.PNG)

![IoC.PNG](IoC.PNG)

PS: There are many variants for mount locker as group runs as Ransomware-as-a-Service(RaaS). So, the above mentioned IoC can be different for file_extension and network logs.

Thank you <3 :heart:
